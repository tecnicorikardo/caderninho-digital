# VerificaÃ§Ã£o - Despesa de Estoque no Financeiro

## âœ… CÃ³digo Implementado Corretamente

O cÃ³digo para registrar despesas de estoque no financeiro **JÃ ESTÃ IMPLEMENTADO** em `src/pages/Stock/index.tsx`.

## ğŸ” Como Verificar se EstÃ¡ Funcionando

### Passo 1: Abrir Console do Navegador
1. Pressione **F12** para abrir as ferramentas de desenvolvedor
2. VÃ¡ na aba **Console**
3. Deixe o console aberto durante os testes

### Passo 2: Criar um Produto com Estoque
1. VÃ¡ em **Estoque** â†’ **Novo Produto**
2. Preencha:
   - **Nome**: Produto Teste
   - **PreÃ§o de Custo**: 50.00
   - **PreÃ§o de Venda**: 100.00
   - **Quantidade Inicial**: 10
   - **Fornecedor**: Fornecedor ABC
3. Clique em **Salvar**

### Passo 3: Verificar Logs no Console
VocÃª deve ver no console:
```
ğŸ’° Registrando despesa de estoque no financeiro...
âœ… Despesa de estoque registrada no financeiro: Compra de estoque - Produto Teste (10x)
```

E um toast (notificaÃ§Ã£o) deve aparecer:
```
Despesa de R$ 500.00 registrada no financeiro!
```

### Passo 4: Verificar no Financeiro
1. VÃ¡ em **FinanÃ§as**
2. Procure por uma transaÃ§Ã£o com:
   - **Tipo**: Despesa (vermelho)
   - **Categoria**: Fornecedores
   - **DescriÃ§Ã£o**: "Compra de estoque - Produto Teste (10x)"
   - **Valor**: R$ 500,00
   - **Status**: Pago

## ğŸ§ª CenÃ¡rios de Teste

### CenÃ¡rio 1: Criar Produto com Estoque Inicial
- **CondiÃ§Ã£o**: Quantidade > 0 E PreÃ§o de Custo > 0
- **Resultado**: âœ… Cria despesa no financeiro
- **Valor**: Quantidade Ã— PreÃ§o de Custo

### CenÃ¡rio 2: Criar Produto SEM Estoque Inicial
- **CondiÃ§Ã£o**: Quantidade = 0
- **Resultado**: âŒ NÃƒO cria despesa (correto, pois nÃ£o houve compra)

### CenÃ¡rio 3: Criar Produto SEM PreÃ§o de Custo
- **CondiÃ§Ã£o**: PreÃ§o de Custo = 0
- **Resultado**: âŒ NÃƒO cria despesa (correto, pois nÃ£o teve custo)

### CenÃ¡rio 4: Editar Produto e Aumentar Quantidade
- **AÃ§Ã£o**: Editar produto e mudar quantidade de 10 para 15
- **Resultado**: âœ… Cria despesa adicional de 5 unidades
- **Valor**: 5 Ã— PreÃ§o de Custo

### CenÃ¡rio 5: Editar Produto e Diminuir Quantidade
- **AÃ§Ã£o**: Editar produto e mudar quantidade de 10 para 5
- **Resultado**: âŒ NÃƒO cria despesa (correto, pois nÃ£o houve compra)

### CenÃ¡rio 6: MovimentaÃ§Ã£o de Entrada
- **AÃ§Ã£o**: Clicar em "Movimentar" â†’ Entrada â†’ 5 unidades
- **Resultado**: âœ… Cria despesa de entrada
- **DescriÃ§Ã£o**: "Entrada de estoque - [Produto] (5x) - [Motivo]"

### CenÃ¡rio 7: MovimentaÃ§Ã£o de SaÃ­da
- **AÃ§Ã£o**: Clicar em "Movimentar" â†’ SaÃ­da â†’ 3 unidades
- **Resultado**: âŒ NÃƒO cria despesa (correto, Ã© saÃ­da)

### CenÃ¡rio 8: Ajuste de Estoque (Aumentar)
- **AÃ§Ã£o**: Clicar em "Movimentar" â†’ Ajuste â†’ 20 unidades (tinha 10)
- **Resultado**: âœ… Cria despesa de 10 unidades (diferenÃ§a)

### CenÃ¡rio 9: Ajuste de Estoque (Diminuir)
- **AÃ§Ã£o**: Clicar em "Movimentar" â†’ Ajuste â†’ 5 unidades (tinha 10)
- **Resultado**: âŒ NÃƒO cria despesa (correto, diminuiu)

## ğŸ› PossÃ­veis Problemas

### Problema 1: Despesa nÃ£o aparece no Financeiro
**Causa**: Cache do navegador
**SoluÃ§Ã£o**: 
1. Pressione **Ctrl + Shift + R** para recarregar sem cache
2. Ou limpe o cache do navegador
3. Ou abra em aba anÃ´nima

### Problema 2: Erro no Console
**Causa**: Problema com localStorage
**SoluÃ§Ã£o**:
1. Abra o console (F12)
2. Digite: `localStorage.clear()`
3. FaÃ§a login novamente

### Problema 3: Toast nÃ£o aparece
**Causa**: FunÃ§Ã£o estÃ¡ sendo executada mas toast nÃ£o mostra
**SoluÃ§Ã£o**: Verifique se o react-hot-toast estÃ¡ configurado no App.tsx

### Problema 4: Despesa duplicada
**Causa**: Clicou em salvar mÃºltiplas vezes
**SoluÃ§Ã£o**: 
1. VÃ¡ em FinanÃ§as
2. Delete as duplicatas manualmente
3. Ou use a funÃ§Ã£o "Limpar Duplicatas" se disponÃ­vel

## ğŸ“Š Estrutura da TransaÃ§Ã£o Criada

```json
{
  "id": "stock_1699999999999_abc123",
  "type": "despesa",
  "category": "Fornecedores",
  "description": "Compra de estoque - Produto Teste (10x)",
  "amount": 500.00,
  "date": "2024-11-15T10:30:00.000Z",
  "paymentMethod": "dinheiro",
  "status": "pago",
  "userId": "user123",
  "createdAt": "2024-11-15T10:30:00.000Z",
  "financialType": "comercial",
  "autoGenerated": true,
  "stockGenerated": true,
  "productName": "Produto Teste",
  "supplier": "Fornecedor ABC"
}
```

## ğŸ”§ Campos Importantes

- **autoGenerated**: `true` - Indica que foi gerada automaticamente
- **stockGenerated**: `true` - Indica que veio do estoque
- **productName**: Nome do produto
- **supplier**: Nome do fornecedor
- **category**: Sempre "Fornecedores"
- **status**: Sempre "pago" (assumindo que foi pago na compra)

## âœ… Checklist de VerificaÃ§Ã£o

- [ ] Console aberto (F12)
- [ ] Criar produto com quantidade > 0 e custo > 0
- [ ] Ver log no console: "ğŸ’° Registrando despesa..."
- [ ] Ver toast: "Despesa de R$ X registrada..."
- [ ] Ir em FinanÃ§as
- [ ] Encontrar despesa com categoria "Fornecedores"
- [ ] Verificar valor correto (quantidade Ã— custo)
- [ ] Verificar descriÃ§Ã£o correta

## ğŸ¯ Resultado Esperado

Quando vocÃª criar um produto com:
- Quantidade: 10
- PreÃ§o de Custo: R$ 50,00

Deve aparecer no Financeiro:
- **Despesa**: R$ 500,00
- **Categoria**: Fornecedores
- **DescriÃ§Ã£o**: Compra de estoque - [Nome do Produto] (10x)
- **Status**: Pago

---

## ğŸ’¡ Dica

Se ainda nÃ£o estiver funcionando, compartilhe:
1. Screenshot do console (F12)
2. Screenshot da pÃ¡gina de FinanÃ§as
3. Dados do produto que vocÃª criou

Isso ajudarÃ¡ a identificar o problema especÃ­fico!
